<!DOCTYPE html><html lang="en-gb"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><title>Generating City Maps - NULLPOINTER</title><meta name="description" content="This post explains how I coded a city map generator for a&hellip;"><meta name="generator" content="Publii Open-Source CMS for Static Site"><link rel="canonical" href="https://tomnullpointer.github.io/gh-pages/generating-city-maps.html"><link rel="alternate" type="application/atom+xml" href="https://tomnullpointer.github.io/gh-pages/feed.xml" title="NULLPOINTER - RSS"><link rel="alternate" type="application/json" href="https://tomnullpointer.github.io/gh-pages/feed.json" title="NULLPOINTER - JSON"><meta property="og:title" content="Generating City Maps"><meta property="og:image" content="https://tomnullpointer.github.io/gh-pages/media/posts/23/1480563951209439235-FIwE-uDXMAwGfs4-2.jpg"><meta property="og:image:width" content="1200"><meta property="og:image:height" content="624"><meta property="og:site_name" content="NULLPOINTER"><meta property="og:description" content="This post explains how I coded a city map generator for a&hellip;"><meta property="og:url" content="https://tomnullpointer.github.io/gh-pages/generating-city-maps.html"><meta property="og:type" content="article"><link rel="preload" href="https://tomnullpointer.github.io/gh-pages/assets/dynamic/fonts/publicsans/publicsans.woff2" as="font" type="font/woff2" crossorigin><link rel="stylesheet" href="https://tomnullpointer.github.io/gh-pages/assets/css/style.css?v=e4d9dbb286ed39acbd89c04735d2c531"><script type="application/ld+json">{"@context":"http://schema.org","@type":"Article","mainEntityOfPage":{"@type":"WebPage","@id":"https://tomnullpointer.github.io/gh-pages/generating-city-maps.html"},"headline":"Generating City Maps","datePublished":"2025-10-06T10:50+01:00","dateModified":"2025-10-06T12:47+01:00","image":{"@type":"ImageObject","url":"https://tomnullpointer.github.io/gh-pages/media/posts/23/1480563951209439235-FIwE-uDXMAwGfs4-2.jpg","height":624,"width":1200},"description":"This post explains how I coded a city map generator for a&hellip;","author":{"@type":"Person","name":"me","url":"https://tomnullpointer.github.io/gh-pages/authors/me/"},"publisher":{"@type":"Organization","name":"me"}}</script><noscript><style>img[loading] {
                    opacity: 1;
                }</style></noscript></head><body class="post-template"><div class="container"><div class="left-bar"><div class="left-bar__inner"><header class="header"><a class="logo" href="https://tomnullpointer.github.io/gh-pages/">NULLPOINTER</a><nav class="navbar"><button class="navbar__toggle" aria-label="Menu" aria-haspopup="true" aria-expanded="false"><span class="navbar__toggle__box"><span class="navbar__toggle__inner">Menu</span></span></button><ul class="navbar__menu"></ul></nav><a class="logo logo--atbottom" href="https://tomnullpointer.github.io/gh-pages/">NULLPOINTER</a></header></div></div><main class="main post"><article class="content"><figure class="content__featured-image content__featured-image--attop"><img src="https://tomnullpointer.github.io/gh-pages/media/posts/23/1480563951209439235-FIwE-uDXMAwGfs4-2.jpg" srcset="https://tomnullpointer.github.io/gh-pages/media/posts/23/responsive/1480563951209439235-FIwE-uDXMAwGfs4-2-xs.jpg 320w, https://tomnullpointer.github.io/gh-pages/media/posts/23/responsive/1480563951209439235-FIwE-uDXMAwGfs4-2-sm.jpg 480w, https://tomnullpointer.github.io/gh-pages/media/posts/23/responsive/1480563951209439235-FIwE-uDXMAwGfs4-2-md.jpg 768w, https://tomnullpointer.github.io/gh-pages/media/posts/23/responsive/1480563951209439235-FIwE-uDXMAwGfs4-2-xl.jpg 1024w" sizes="(min-width: 1460px) 938px, (min-width: 1200px) calc(75.83vw - 154px), (min-width: 1120px) 938px, (min-width: 900px) calc(55vw + 333px), 100vw" loading="eager" height="624" width="1200" alt="" aria-describedby="image-caption"></figure><div class="main__inner"><div class="content__meta"><div class="content__date"><time datetime="2025-10-06T10:50">Oct 6, 2025</time></div></div><header class="content__header"><h1 class="content__title">Generating City Maps</h1></header><div class="content__entry"><p>This post explains how I coded a city map generator for a project that never made it to full production. Some of the techniques involved are similar to the <a href="https://tomnullpointer.github.io/gh-pages/generating-a-fantasy-map.html">Fantasy Map Generator</a> I worked on. My ambition with this project was to create a city map with sensible zoning, navigation and plot generation for housing etc.</p><figure class="post__image"><img loading="lazy" src="https://tomnullpointer.github.io/gh-pages/media/posts/23/1473996160092225543-FHSu-LLWUAAQxC7-3.jpg" alt="" width="1200" height="687" sizes="(min-width: 760px) 660px, calc(93.18vw - 30px)" srcset="https://tomnullpointer.github.io/gh-pages/media/posts/23/responsive/1473996160092225543-FHSu-LLWUAAQxC7-3-xs.jpg 320w, https://tomnullpointer.github.io/gh-pages/media/posts/23/responsive/1473996160092225543-FHSu-LLWUAAQxC7-3-sm.jpg 480w, https://tomnullpointer.github.io/gh-pages/media/posts/23/responsive/1473996160092225543-FHSu-LLWUAAQxC7-3-md.jpg 768w, https://tomnullpointer.github.io/gh-pages/media/posts/23/responsive/1473996160092225543-FHSu-LLWUAAQxC7-3-xl.jpg 1024w"></figure><h1>Starting with graphs</h1><p>For the basic data structure I tried two different graph formats. One was a warped quad grid, as used in games like Townscaper. There is a good explainer of the process for generating such grids <a href="https://www.boristhebrave.com/docs/sylves/1/articles/tutorials/townscaper.html" target="_blank" rel="noopener noreferrer">here</a><a href="https://www.boristhebrave.com/docs/sylves/1/articles/tutorials/townscaper.html" target="_blank" rel="noopener noreferrer"></a>.</p><p>This format as the advantages of every cell being a quad and therefore always having 4 neighbours. This in turn leads to the possibility of generating objects within the cells that can make use of bitmasked tile variation - a method of composing objects out of parts based on connections to their neighbours, you see this frequently in 2d tile based games (<a href="https://code.tutsplus.com/how-to-use-tile-bitmasking-to-auto-tile-your-level-layouts--cms-25673t" target="_blank" rel="noopener noreferrer">here is a good explainer)</a></p><p>Obviously knowing that each cell can have 4 walls helps enormously if you want to end up with continuous building structures (see Townscaper!).</p><p>The image below shows how I split this warped quad grid into different city districts (biomes). I also assign a margin of cells at the edges to be either ocean or containing mountain in order to give the city edges. One of the biomes is a river which is positioned more deliberately than the other districts (as it has to connect ot the ocean and ideally spans across the majority of the map. </p><p>In this variant of the approach I also link cells together to create "blocks" that function a little bit like interconnected apartment complexes etc. This was in preparation for a bitmasked style 3d or sprite based decorating phase.</p><figure class="post__image"><img loading="lazy" src="https://tomnullpointer.github.io/gh-pages/media/posts/23/1661996108413906944-FxCYgCCXwAAbnLX.jpg" alt="" width="1020" height="852" sizes="(min-width: 760px) 660px, calc(93.18vw - 30px)" srcset="https://tomnullpointer.github.io/gh-pages/media/posts/23/responsive/1661996108413906944-FxCYgCCXwAAbnLX-xs.jpg 320w, https://tomnullpointer.github.io/gh-pages/media/posts/23/responsive/1661996108413906944-FxCYgCCXwAAbnLX-sm.jpg 480w, https://tomnullpointer.github.io/gh-pages/media/posts/23/responsive/1661996108413906944-FxCYgCCXwAAbnLX-md.jpg 768w, https://tomnullpointer.github.io/gh-pages/media/posts/23/responsive/1661996108413906944-FxCYgCCXwAAbnLX-xl.jpg 1024w"></figure><h1>Pathing</h1><p>In a similar approach to my Fantasy Map Generator, i place a loose grid of Key Road destinations and then connect those with a A* pathfinding algorithm (removing some and shuffling the route with a few random penalties) The roads follow cell edges and are naturally perturbed even if the underlying structure has no inbuilt penalties. I did however add a light amount of 2d noise to the nodes in order to make the roads a bit more variable.</p><p>It is at this point that I became dissatisfied with the townscaper map approach. My cells could end arranged with very acute edges (see the bottom left roads for an example). Since my roads path along the edges of cells the generator would end up making these zigzag patterns that I didn't like. The other limitation is that all the cells remain roughly the same size, so all the basic house plots are similar sized. </p><p>These limitations can be overcome with more work on relaxing the grid and merging cells, but I decided to try my old favourite alternative. The Voronoi Graph.</p><h1>Voronoi Approach</h1><figure class="post__image"><img loading="lazy" src="https://tomnullpointer.github.io/gh-pages/media/posts/23/1661991473062248448-FxCUSK4WcAAC6nE.png" alt="" width="910" height="752" sizes="(min-width: 760px) 660px, calc(93.18vw - 30px)" srcset="https://tomnullpointer.github.io/gh-pages/media/posts/23/responsive/1661991473062248448-FxCUSK4WcAAC6nE-xs.png 320w, https://tomnullpointer.github.io/gh-pages/media/posts/23/responsive/1661991473062248448-FxCUSK4WcAAC6nE-sm.png 480w, https://tomnullpointer.github.io/gh-pages/media/posts/23/responsive/1661991473062248448-FxCUSK4WcAAC6nE-md.png 768w, https://tomnullpointer.github.io/gh-pages/media/posts/23/responsive/1661991473062248448-FxCUSK4WcAAC6nE-xl.png 1024w"></figure><p>The generation process is broadly similar, except each cell is not restricted to being a quad and the resulting mesh is less grid-like. This leads to more variance in the cell shapes and sizes across the map. Also, by placing the seed voronoi cell points in different configurations I can create different styles of layout; gridded, radial etc.</p><p>Roads are calculated in the same way as before, but after pathing is finished I run a function to add margins along every cell edge that bordered a path. In the image above you can see an issue where the end of roads taper, this isn't too hard to fix, I just didn't get around to it!</p><h1>Housing</h1><p>To create housing plots I take each cell and bisect it a number of times. These divisions are set to split the cells evenly (to avoid making slivers of geometry). I repeat the process several times (based on the initial size of the cell and a lower limit for child areas produced) allowing the creation of subblocks and alleyways in each cell. </p><p>After the plots are defined I perform a basic square packing routine to see how many buildings I can fit into the remaining plot. This has an element of randomness included to ensure a nice range of building sizes and any plots that are too narrow are eliminated (drawn in red above)</p><figure class="post__image"><img loading="lazy" src="https://tomnullpointer.github.io/gh-pages/media/posts/23/1480563951209439235-FIwE-uDXMAwGfs4.jpg" alt="" width="1200" height="624" sizes="(min-width: 760px) 660px, calc(93.18vw - 30px)" srcset="https://tomnullpointer.github.io/gh-pages/media/posts/23/responsive/1480563951209439235-FIwE-uDXMAwGfs4-xs.jpg 320w, https://tomnullpointer.github.io/gh-pages/media/posts/23/responsive/1480563951209439235-FIwE-uDXMAwGfs4-sm.jpg 480w, https://tomnullpointer.github.io/gh-pages/media/posts/23/responsive/1480563951209439235-FIwE-uDXMAwGfs4-md.jpg 768w, https://tomnullpointer.github.io/gh-pages/media/posts/23/responsive/1480563951209439235-FIwE-uDXMAwGfs4-xl.jpg 1024w"></figure><p>Once the data structure is complete I render the map placing building sprites and other decorations within the list of plots (aligning them to their plot direction and scaling them to fit). There are a range of rules to select the sprites based on biome/district type, frequency of building type, size of plot and proximity to other cell types etc.</p><p>Just for fun I assigned some randomly generated names to the districts and add a bit of relevant typography.</p><p>I'd love to return to this prototype some day!</p><p> </p></div><footer class="content__footer"><div class="content__last-updated">This article was updated on <time datetime="2025-10-06T12:47">Oct 6, 2025</time></div></footer></div></article><div class="content__section post__related"><div class="main__inner"><h3 class="content__section__title">Related post</h3><div class="post__related__wrap"><article class="c-card"><div class="c-card__meta"><div class="c-card__author"><a href="https://tomnullpointer.github.io/gh-pages/authors/me/">me</a></div><time datetime="2025-10-05T20:09">Oct 5, 2025 </time><a href="https://tomnullpointer.github.io/gh-pages/tags/explainer/" class="c-card-tag">Explainer</a></div><a href="https://tomnullpointer.github.io/gh-pages/generating-a-fantasy-map.html" class="c-card__image"><img src="https://tomnullpointer.github.io/gh-pages/media/posts/22/1470365535468761092-FGfHYSyWQAcjoWG.jpg" srcset="https://tomnullpointer.github.io/gh-pages/media/posts/22/responsive/1470365535468761092-FGfHYSyWQAcjoWG-xs.jpg 320w, https://tomnullpointer.github.io/gh-pages/media/posts/22/responsive/1470365535468761092-FGfHYSyWQAcjoWG-sm.jpg 480w" sizes="(min-width: 700px) 200px, (min-width: 480px) 160px, calc(100vw - 50px)" loading="lazy" height="626" width="1200" alt=""></a><header class="c-card__header"><h2 class="c-card__title"><a href="https://tomnullpointer.github.io/gh-pages/generating-a-fantasy-map.html">Generating a Fantasy Map</a></h2><p>This post presents the various stages of design and coding that I&hellip;</p></header></article><article class="c-card"><div class="c-card__meta"><div class="c-card__author"><a href="https://tomnullpointer.github.io/gh-pages/authors/me/">me</a></div><time datetime="2025-10-05T18:51">Oct 5, 2025 </time><a href="https://tomnullpointer.github.io/gh-pages/tags/archive/" class="c-card-tag">Archive</a></div><a href="https://tomnullpointer.github.io/gh-pages/procedurally-generating-books.html" class="c-card__image"><img src="https://tomnullpointer.github.io/gh-pages/media/posts/20/1732442787457446125-GArfeUqXgAAGnSi-2.png" srcset="https://tomnullpointer.github.io/gh-pages/media/posts/20/responsive/1732442787457446125-GArfeUqXgAAGnSi-2-xs.png 320w, https://tomnullpointer.github.io/gh-pages/media/posts/20/responsive/1732442787457446125-GArfeUqXgAAGnSi-2-sm.png 480w" sizes="(min-width: 700px) 200px, (min-width: 480px) 160px, calc(100vw - 50px)" loading="lazy" height="586" width="618" alt=""></a><header class="c-card__header"><h2 class="c-card__title"><a href="https://tomnullpointer.github.io/gh-pages/procedurally-generating-books.html">Procedurally Generating Books</a></h2><p>This is a record of my day to day work on a&hellip;</p></header></article><article class="c-card"><div class="c-card__meta"><div class="c-card__author"><a href="https://tomnullpointer.github.io/gh-pages/authors/me/">me</a></div><time datetime="2025-10-05T11:20">Oct 5, 2025 </time><a href="https://tomnullpointer.github.io/gh-pages/tags/procedural-generation/" class="c-card-tag">Procedural Generation</a></div><a href="https://tomnullpointer.github.io/gh-pages/generating-procedural-insects-with-ik.html" class="c-card__image"><img src="https://tomnullpointer.github.io/gh-pages/media/posts/16/1109928671727501312-D2dCOU0WoAYCyVa-2.png" srcset="https://tomnullpointer.github.io/gh-pages/media/posts/16/responsive/1109928671727501312-D2dCOU0WoAYCyVa-2-xs.png 320w, https://tomnullpointer.github.io/gh-pages/media/posts/16/responsive/1109928671727501312-D2dCOU0WoAYCyVa-2-sm.png 480w" sizes="(min-width: 700px) 200px, (min-width: 480px) 160px, calc(100vw - 50px)" loading="lazy" height="460" width="652" alt=""></a><header class="c-card__header"><h2 class="c-card__title"><a href="https://tomnullpointer.github.io/gh-pages/generating-procedural-insects-with-ik.html">Generating procedural Insects with IK</a></h2><p>This project was an experiment in generating insect models from procedural meshes&hellip;</p></header></article></div></div></div></main><div class="right-bar"><div class="right-bar__inner"><div class="sidebar"><section class="box featured"><h3 class="box__title">Featured Posts</h3><ul class="featured__container"><li class="featured__item"><a href="https://tomnullpointer.github.io/gh-pages/about-me-post.html" class="featured__image"><img src="https://tomnullpointer.github.io/gh-pages/media/posts/7/responsive/instapic-xs.png" loading="lazy" alt="" height="505" width="505"></a><div><a href="https://tomnullpointer.github.io/gh-pages/about-me-post.html" class="featured__title">About Me</a></div></li><li class="featured__item"><a href="https://tomnullpointer.github.io/gh-pages/about-my-academic-practice.html" class="featured__image"><img src="https://tomnullpointer.github.io/gh-pages/media/posts/9/responsive/mexico1-md-xs.jpg" loading="lazy" alt="" height="513" width="513"></a><div><a href="https://tomnullpointer.github.io/gh-pages/about-my-academic-practice.html" class="featured__title">Academic Practice</a></div></li><li class="featured__item"><a href="https://tomnullpointer.github.io/gh-pages/cv-bio.html" class="featured__image"><img src="https://tomnullpointer.github.io/gh-pages/media/posts/15/responsive/Bio-data-format-2-724x1024-3615278986-xs.jpg" loading="lazy" alt="" height="1024" width="1024"></a><div><a href="https://tomnullpointer.github.io/gh-pages/cv-bio.html" class="featured__title">C.V. Bio</a></div></li><li class="featured__item"><a href="https://tomnullpointer.github.io/gh-pages/nullpointer-games.html" class="featured__image"><img src="https://tomnullpointer.github.io/gh-pages/media/posts/8/responsive/ss_244d42e4eed84c0d5e1413914cb6bef2911d3300.1920x1080-md-xs.jpg" loading="lazy" alt="" height="432" width="432"></a><div><a href="https://tomnullpointer.github.io/gh-pages/nullpointer-games.html" class="featured__title">Commercial Games</a></div></li><li class="featured__item"><a href="https://tomnullpointer.github.io/gh-pages/game-jams-and-freebies.html" class="featured__image"><img src="https://tomnullpointer.github.io/gh-pages/media/posts/14/responsive/2025-10-04-22_31_47-Publii-md-xs.png" loading="lazy" alt="" height="445" width="445"></a><div><a href="https://tomnullpointer.github.io/gh-pages/game-jams-and-freebies.html" class="featured__title">Game Jams and Freebies</a></div></li></ul></section><section class="box tags"><h3 class="box__title">Recommended Topics</h3><ul class="tags__list"><li class="tags__item"><a href="https://tomnullpointer.github.io/gh-pages/tags/about/" class="btn btn--gray">About <sup>(4)</sup></a></li><li class="tags__item"><a href="https://tomnullpointer.github.io/gh-pages/tags/archive/" class="btn btn--gray">Archive <sup>(6)</sup></a></li><li class="tags__item"><a href="https://tomnullpointer.github.io/gh-pages/tags/explainer/" class="btn btn--gray">Explainer <sup>(6)</sup></a></li><li class="tags__item"><a href="https://tomnullpointer.github.io/gh-pages/tags/game-development/" class="btn btn--gray">Game Development <sup>(4)</sup></a></li><li class="tags__item"><a href="https://tomnullpointer.github.io/gh-pages/tags/installation-art/" class="btn btn--gray">Installation Art <sup>(1)</sup></a></li><li class="tags__item"><a href="https://tomnullpointer.github.io/gh-pages/tags/isosurfaces/" class="btn btn--gray">IsoSurfaces <sup>(3)</sup></a></li><li class="tags__item"><a href="https://tomnullpointer.github.io/gh-pages/tags/procedural-generation/" class="btn btn--gray">Procedural Generation <sup>(12)</sup></a></li></ul></section></div></div></div></div><script defer="defer" src="https://tomnullpointer.github.io/gh-pages/assets/js/scripts.min.js?v=b2d91bcadbf5db401b76eb5bb3092eb7"></script><script>var images = document.querySelectorAll('img[loading]');
        for (var i = 0; i < images.length; i++) {
            if (images[i].complete) {
                images[i].classList.add('is-loaded');
            } else {
                images[i].addEventListener('load', function () {
                    this.classList.add('is-loaded');
                }, false);
            }
        }</script></body></html>